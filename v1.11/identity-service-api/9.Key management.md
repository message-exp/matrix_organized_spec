## 金鑰管理

身份伺服器有一些長期的公私鑰對。這些鑰對以 `algorithm:identifier` 命名，例如 `ed25519:0`。在簽署關聯時，遵循標準的[簽署 JSON](https://spec.matrix.org/v1.11/appendices#signing-json)算法。

身份伺服器還可以跟踪一些短期的公私鑰對，這些鑰對的使用和壽命特徵可能與服務的長期鑰不同。

# GET
/_matrix/identity/v2/pubkey/ephemeral/isvalid

---

檢查短期公鑰是否有效。

| 是否限速: | 否 |
| --- | --- |
| 是否需要身份驗證: | 否 |

---

## 請求

### 請求參數

查詢參數
| 名稱 | 類型 | 說明 |
| --- | --- | --- |
| `public_key` | `string` | **必填:** 需要檢查的無填充base64編碼的公鑰。 |

---

## 回應

| 狀態 | 說明 |
| --- | --- |
| `200` | 公鑰的有效性。 |

### 200 回應

| 名稱 | 類型 | 說明 |
| --- | --- | --- |
| `valid` | `boolean` | **必填:** 公鑰是否被識別並且當前有效。 |
```
{
"valid": true
}
```


# GET
/_matrix/identity/v2/pubkey/isvalid

---

檢查長期公鑰是否有效。只要鑰存在，回應應該始終相同。

| 是否限速: | 否 |
| --- | --- |
| 是否需要身份驗證: | 否 |

---

## 請求

### 請求參數

查詢參數
| 名稱 | 類型 | 說明 |
| --- | --- | --- |
| `public_key` | `string` | **必填:** 需要檢查的無填充base64編碼的公鑰。 |

---

## 回應

| 狀態 | 說明 |
| --- | --- |
| `200` | 公鑰的有效性。 |

### 200 回應

| 名稱 | 類型 | 說明 |
| --- | --- | --- |
| `valid` | `boolean` | **必填:** 公鑰是否被識別並且當前有效。 |

```
{
"valid": true
}
```


# GET
/_matrix/identity/v2/pubkey/{keyId}

---

根據傳遞的鑰ID獲取公鑰。

| 是否限速: | 否 |
| --- | --- |
| 是否需要身份驗證: | 否 |

---

## 請求

### 請求參數

路徑參數
| 名稱 | 類型 | 說明 |
| --- | --- | --- |
| `keyId` | `string` | **必填:** 鑰ID。應該採用 algorithm:identifier 形式，其中 algorithm 標識簽名算法，identifier 是不透明字符串。 |

---

## 回應

| 狀態 | 說明 |
| --- | --- |
| `200` | 公鑰存在。 |
| `404` | 找不到公鑰。 |

### 200 回應

| 名稱 | 類型 | 說明 |
| --- | --- | --- |
| `public_key` | `string` | **必填:** 無填充base64編碼的公鑰。 |

```
{
"public_key": "VXuGitF39UH5iRfvbIknlvlAVKgD1BsLDMvBf0pmp7c"
}
```


### 404 回應

錯誤
| 名稱 | 類型 | 說明 |
| --- | --- | --- |
| `errcode` | `string` | **必填:** 錯誤碼。 |
| `error` | `string` | 人類可讀的錯誤信息。 |

```
{
"errcode": "M_NOT_FOUND",
"error": "找不到公鑰"
}
```


